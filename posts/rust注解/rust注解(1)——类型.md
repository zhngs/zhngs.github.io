---
date: '2022-05-28'
---
# ä¸€.å˜é‡

rustä½¿ç”¨ `let`å…³é”®å­—å£°æ˜å˜é‡ï¼Œè¯­æ³•ä¸º `let name: type = expression`ï¼Œå…¶ä¸­typeå’Œexpressionå¯ä»¥çœç•¥

- å¦‚æœçœç•¥typeï¼Œåˆ™typeä¼šç”±expressionæ¨å¯¼å‡ºæ¥
- å¦‚æœçœç•¥expressionï¼Œ`åˆå§‹å€¼å¿…å®šåœ¨å£°æ˜è¯­å¥ä¸‹æ–¹çš„æŸä¸€ä¸ªä½ç½®ï¼Œå¦‚æœrustå˜é‡æ²¡æœ‰è¢«èµ‹å€¼è€Œä½¿ç”¨ï¼Œåˆ™ä¼šæŠ¥é”™`

```rust
let x: i32 = 5;
let y;
y = 6;
```

rustä¸­å˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼Œå³ä¸èƒ½æ”¹å˜å˜é‡çš„å€¼ï¼Œå¦‚æœæƒ³è¦æ”¹å˜éœ€è¦åŠ  `mut`å…³é”®å­—

```rust
let mut x = 5;
x = 6;
```

# äºŒ.å¸¸é‡

rustå¸¸é‡ä½¿ç”¨ `const`å…³é”®å­—å£°æ˜ï¼Œå¹¶ä¸” `å¿…é¡»æ ‡æ˜å€¼çš„ç±»å‹`

```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;
```

# ä¸‰.æ•°æ®ç±»å‹

## 1.æ ‡é‡ç±»å‹

### 1.1 æ•´å‹

| é•¿åº¦    | æœ‰ç¬¦å·    | æ— ç¬¦å·    |
| ------- | --------- | --------- |
| 8-bit   | `i8`    | `u8`    |
| 16-bit  | `i16`   | `u16`   |
| 32-bit  | `i32`   | `u32`   |
| 64-bit  | `i64`   | `u64`   |
| 128-bit | `i128`  | `u128`  |
| arch    | `isize` | `usize` |

æ•°å­—ç±»å‹é»˜è®¤æ˜¯ `i32`çš„ï¼Œ`isize`Â å’ŒÂ `usize`Â ç±»å‹ä¾èµ–è¿è¡Œç¨‹åºçš„è®¡ç®—æœºæ¶æ„ï¼š64 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 64 ä½çš„ï¼Œ 32 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 32 ä½çš„ï¼Œæ•´å‹çš„å­—é¢é‡æœ‰å¦‚ä¸‹çš„å½¢å¼

| æ•°å­—å­—é¢å€¼                       | ä¾‹å­            |
| -------------------------------- | --------------- |
| Decimal (åè¿›åˆ¶)                 | `98_222`      |
| Hex (åå…­è¿›åˆ¶)                   | `0xff`        |
| Octal (å…«è¿›åˆ¶)                   | `0o77`        |
| Binary (äºŒè¿›åˆ¶)                  | `0b1111_0000` |
| Byte (å•å­—èŠ‚å­—ç¬¦)(ä»…é™äº `u8`) | `b'A'`        |

### 1.2 æµ®ç‚¹å‹

ç±»å‹ä¸º `f32`å’Œ `f64`ï¼Œæµ®ç‚¹ç±»å‹é»˜è®¤æ˜¯ `f64`

### 1.3 å¸ƒå°”å‹

ç±»å‹ä¸º `bool`ï¼Œæœ‰ `true`å’Œ `false`ä¸¤ä¸ªå€¼

### 1.4 å­—ç¬¦ç±»å‹

ç±»å‹ä¸º `char`ï¼ŒRust çš„Â `char`Â ç±»å‹çš„å¤§å°ä¸ºå››ä¸ªå­—èŠ‚(four bytes)ï¼Œå¹¶ä»£è¡¨äº†ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼ˆUnicode Scalar Valueï¼‰

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let heart_eyed_cat = 'ğŸ˜»';
}
```

### 1.5 å­—ç¬¦ä¸²ç±»å‹

ç±»å‹ä¸º `str`ï¼Œæœ¬è´¨æ˜¯UTF-8ç¼–ç å­—ç¬¦ä¸²æ•°æ®ï¼Œå®ƒé€šå¸¸ä»¥å­—ç¬¦ä¸²sliceçš„å½¢å¼å‡ºç°

## 2.å¤åˆç±»å‹

### 2.1 å…ƒç»„

ç±»å‹ä¸º `(T1, T2, T3, ...)`

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰æ¥è§£æ„ï¼ˆdestructureï¼‰å…ƒç»„å€¼

```rust
fn main() {
    let tup = (500, 6.4, 1);
    let (x, y, z) = tup;
}
```

å¯ä»¥ä½¿ç”¨ç‚¹å·ï¼ˆ`.`ï¼‰åè·Ÿå€¼çš„ç´¢å¼•æ¥ç›´æ¥è®¿é—®

```rust
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);
    let five_hundred = x.0;
    let six_point_four = x.1;
    let one = x.2;
}
```

noteï¼šæ²¡æœ‰ä»»ä½•å€¼çš„å…ƒç»„Â `()`Â æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼Œä¹Ÿå†™æˆÂ `()`Â ã€‚è¯¥ç±»å‹è¢«ç§°ä¸ºÂ **å•å…ƒç±»å‹**ï¼ˆ*unit type*ï¼‰ï¼Œè€Œè¯¥å€¼è¢«ç§°ä¸ºÂ **å•å…ƒå€¼**ï¼ˆ*unit value*ï¼‰ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œåˆ™ä¼šéšå¼è¿”å›å•å…ƒå€¼ã€‚

### 2.2 æ•°ç»„

ç±»å‹ä¸º `[T; N]`ï¼ŒTä¸ºç±»å‹ï¼ŒNä¸ºé•¿åº¦

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
let b = [3; 5]; //ç­‰åŒäºlet a = [3, 3, 3, 3, 3];
```

å¯ä»¥é€šè¿‡åœ¨æ–¹æ‹¬å·ä¸­æŒ‡å®šåˆå§‹å€¼åŠ åˆ†å·å†åŠ å…ƒç´ ä¸ªæ•°çš„æ–¹å¼æ¥åˆ›å»ºä¸€ä¸ªæ¯ä¸ªå…ƒç´ éƒ½ä¸ºç›¸åŒå€¼çš„æ•°ç»„

### 2.3 ç»“æ„ä½“

å®šä¹‰ç»“æ„ä½“çš„è¯­æ³•ä¸º `struct T{...}`ï¼Œå°±å­˜åœ¨äº†ä¸€ä¸ªç±»å‹ä¸º `T`çš„ç»“æ„ä½“

```rust
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}
fn main() {
    let user1 = User {
        email: String::from("someone@example.com"),
        username: String::from("someusername123"),
        active: true,
        sign_in_count: 1,
    };
}
```

`å…ƒç»„ç»“æ„ä½“ï¼ˆtuple structsï¼‰`æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç»“æ„ä½“ï¼Œæœ‰è‡ªå·±çš„ç±»å‹åï¼Œä½†æ²¡æœ‰å…·ä½“çš„å­—æ®µåï¼Œåªæœ‰å­—æ®µçš„ç±»å‹

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);
fn main() {
    let black = Color(0, 0, 0);
    let origin = Point(0, 0, 0);
}
```

`ç±»å•å…ƒç»“æ„ä½“ï¼ˆunit-like structsï¼‰`å†…æ²¡æœ‰å­—æ®µï¼Œå¸¸ç”¨åœ¨æŸä¸ªç±»å‹ä¸Šå®ç°traitä½†ä¸éœ€è¦åœ¨ç±»å‹ä¸­å­˜å‚¨æ•°æ®çš„æ—¶å€™å‘æŒ¥ä½œç”¨

```rust
struct AlwaysEqual;
fn main() {
    let subject = AlwaysEqual;
}
```

### 2.4 æšä¸¾

rustçš„æšä¸¾åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯ä»¥å°†ä»»æ„ç±»å‹çš„æ•°æ®æ”¾å…¥æšä¸¾æˆå‘˜ä¸­ï¼Œæšä¸¾å’Œæ¨¡å¼åŒ¹é…ä¼šå‘æŒ¥å‡ºå·¨å¤§çš„å¨åŠ›

- `Quit`Â æ²¡æœ‰å…³è”ä»»ä½•æ•°æ®ï¼Œå¯ä»¥çœ‹åšç±»å•å…ƒç»“æ„ä½“
- `Move`Â ç±»ä¼¼ç»“æ„ä½“åŒ…å«å‘½åå­—æ®µï¼Œå¯ä»¥çœ‹åšæ™®é€šç»“æ„ä½“
- `Write`Â åŒ…å«å•ç‹¬ä¸€ä¸ªÂ `String`ï¼Œå¯ä»¥çœ‹åšå…ƒç»„ç»“æ„ä½“
- `ChangeColor`Â åŒ…å«ä¸‰ä¸ªÂ `i32`ï¼Œå¯ä»¥çœ‹åšå…ƒç»„ç»“æ„ä½“

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}
```

æœ‰ä¸¤ä¸ªéå¸¸å¸¸ç”¨çš„æšä¸¾ï¼ŒOptionå’ŒResult
- Optionå¯ä»¥ç”¨æ¥è¡¨ç¤ºç©ºå€¼çš„æ¦‚å¿µï¼ŒNoneå’ŒSomeå¯ä»¥ç›´æ¥ä½¿ç”¨
- Resultç”¨æ¥è¡¨ç¤ºå¯èƒ½å‡ºé”™çš„æƒ…å†µ
```rust
enum Option<T> {
    None,
    Some(T),
}

enum Result<T, E> {
    Ok(T),
    Err(E),
}
```

## 3.å¼•ç”¨ç±»å‹

### 3.1 å¼•ç”¨

ä¸å¯å˜å¼•ç”¨çš„ `ç±»å‹`ä¸º `&T`ï¼Œå¯å˜å¼•ç”¨çš„ç±»å‹ä¸º `&mut T`

**å¼•ç”¨**ï¼ˆ*reference*ï¼‰åƒä¸€ä¸ªæŒ‡é’ˆï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåœ°å€ï¼Œä½¿ç”¨(`&`)è¿ç®—ç¬¦æ¥åˆ›å»ºä¸€ä¸ªå¼•ç”¨ï¼Œä½¿ç”¨(`*`)è¿ç®—ç¬¦æ¥è§£å¼•ç”¨

```rust
fn main() {
    let s1 = String::from("hello");
    let len = calculate_length(&s1);
    println!("The length of '{}' is {}.", s1, len);
}

fn calculate_length(s: &String) -> usize {
    s.len()
}
```

å¼•ç”¨é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼Œæƒ³è¦ `åˆ›å»ºå¯å˜å¼•ç”¨éœ€è¦ä½¿ç”¨mutå…³é”®å­—`

```rust
fn main() {
    let mut s = String::from("hello");
    change(&mut s);
}

fn change(some_string: &mut String) {
    some_string.push_str(", world");
}
```

### 3.2 slice

`sliceæœ¬è´¨ä¹Ÿæ˜¯å¼•ç”¨ï¼Œä¸å…·æœ‰æ‰€æœ‰æƒï¼Œå­—ç¬¦ä¸²å­—é¢å€¼å°±æ˜¯slice`ï¼Œè¿™é‡ŒÂ `s`Â çš„ç±»å‹æ˜¯Â `&str`ï¼šå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘äºŒè¿›åˆ¶ç¨‹åºç‰¹å®šä½ç½®çš„ sliceã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå­—ç¬¦ä¸²å­—é¢å€¼æ˜¯ä¸å¯å˜çš„ï¼Œå› ä¸º `&str`Â æ˜¯ä¸€ä¸ªä¸å¯å˜å¼•ç”¨

```rust
let s = "Hello, world!";
```

`æ•°ç»„ä¹Ÿå¯ä»¥å¼•ç”¨ä¸€éƒ¨åˆ†ä½œä¸ºslice`ï¼Œä¸‹é¢sliceçš„ç±»å‹æ˜¯Â `&[i32]`ï¼Œå­˜å‚¨äº†æ•°ç»„å…ƒç´ çš„å¼•ç”¨å’Œé›†åˆé•¿åº¦

```rust
let a = [1, 2, 3, 4, 5];
let slice = &a[1..3];
assert_eq!(slice, &[2, 3]);
```
